import{a as c,j as e}from"./vendor-react-Coyc-9rJ.js";import{u as ee,c as g,a as z}from"./index-BahTgtJs.js";import{X as se,Q as H,a2 as F,c as W,aI as oe,D as me,z as $,A as K,g as te,o as Q,x as J,m as xe,a3 as ue,j as he,K as pe}from"./vendor-icons-CczvD28u.js";import{v as X}from"./vendor-uuid-CtRu48qb.js";import"./vendor-DW9sAQKa.js";import"./vendor-zustand-Bm6pua9f.js";function ge({onClose:s}){const{addValidationReport:A}=ee(),[f,j]=c.useState("EVT"),[y,q]=c.useState("Verification"),[w,k]=c.useState(""),[v,V]=c.useState(""),[T,R]=c.useState("1.0"),[C,S]=c.useState(""),[I,D]=c.useState(""),[t,d]=c.useState(""),[o,x]=c.useState(""),[P,u]=c.useState(""),[B,O]=c.useState(""),[h,a]=c.useState([]),[m,N]=c.useState([]),[p,b]=c.useState([]),[M,ae]=c.useState("Not Tested"),[Y,re]=c.useState(""),[Z,ne]=c.useState(""),[E,_]=c.useState([]),[U,G]=c.useState([]),ie=()=>{a([...h,{id:X(),requirementId:`REQ-${String(h.length+1).padStart(3,"0")}`,description:"",category:"Performance",acceptanceCriteria:"",verificationMethod:"Test"}])},le=()=>{N([...m,{id:X(),testMethodId:`TM-${String(m.length+1).padStart(3,"0")}`,title:"",type:"Functional",procedure:"",acceptanceCriteria:"",equipment:""}])},de=()=>{b([...p,{id:X(),testMethodId:m[0]?.id||"",requirementId:h[0]?.id||"",measuredValue:"",outcome:"Not Tested",testedBy:v,notes:""}])},ce=()=>{if(!w||!v||!I||!C)return;const r=`${f}-${new Date().getFullYear()}-${String(Math.floor(Math.random()*999)+1).padStart(3,"0")}`;A({reportNumber:r,title:w,type:f,category:y,status:"Draft",version:T,author:v,reviewers:[],approvers:[],objective:C,deviceUnderTest:{name:I,partNumber:t,revision:o,description:P,softwareVersion:B||void 0},testMethods:m.map(l=>({id:l.id,testMethodId:l.testMethodId,title:l.title,description:l.procedure,type:l.type,equipment:l.equipment.split(",").map(i=>i.trim()).filter(Boolean),procedure:l.procedure,acceptanceCriteria:l.acceptanceCriteria,isoReferences:[]})),requirements:h.map(l=>({id:l.id,requirementId:l.requirementId,description:l.description,category:l.category,source:"",acceptanceCriteria:l.acceptanceCriteria,verificationMethod:l.verificationMethod,isoReferences:[]})),testResults:p.map(l=>({id:l.id,testMethodId:l.testMethodId,requirementId:l.requirementId,measuredValue:l.measuredValue||void 0,acceptanceCriteria:h.find(i=>i.id===l.requirementId)?.acceptanceCriteria||"",outcome:l.outcome,testedBy:l.testedBy,testedAt:new Date,notes:l.notes||void 0})),overallConclusion:M,conclusionSummary:Y,nonConformances:E,failures:[],designChangeRecommendations:U,discussionNotes:Z,linkedNCRs:[],linkedCAPAs:[],linkedChangeControls:[],linkedRiskAssessments:[],linkedDocuments:[],isoReferences:[{standard:"ISO 13485",clause:y==="Verification"?"7.3.6":"7.3.7",description:y==="Verification"?"Design and development verification":"Design and development validation"}],auditTrail:[]}),s()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:s,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl mx-4 max-h-[85vh] flex flex-col",onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-surface-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"New Engineering Validation Report"}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-surface-100 rounded-md",children:e.jsx(se,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3 uppercase tracking-wide",children:"Report Metadata"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Report Type *"}),e.jsxs("select",{value:f,onChange:r=>j(r.target.value),className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm",children:[e.jsx("option",{value:"EVT",children:"EVT - Engineering Validation"}),e.jsx("option",{value:"DVT",children:"DVT - Design Validation"}),e.jsx("option",{value:"PVT",children:"PVT - Production Validation"}),e.jsx("option",{value:"DVP&R",children:"DVP&R - Design Verification Plan & Report"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),e.jsxs("select",{value:y,onChange:r=>q(r.target.value),className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm",children:[e.jsx("option",{value:"Verification",children:'Verification - "Did I build it right?"'}),e.jsx("option",{value:"Validation",children:'Validation - "Did I build the right thing?"'})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Version"}),e.jsx("input",{type:"text",value:T,onChange:r=>R(r.target.value),className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:w,onChange:r=>k(r.target.value),placeholder:"e.g., Cardiac Monitor Sensor Module - Engineering Validation",className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Author *"}),e.jsx("input",{type:"text",value:v,onChange:r=>V(r.target.value),placeholder:"Name",className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3 uppercase tracking-wide",children:"Objective / Purpose"}),e.jsx("textarea",{value:C,onChange:r=>S(r.target.value),rows:3,placeholder:"Describe the purpose of this validation report...",className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3 uppercase tracking-wide",children:"Device Under Test (DUT)"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:I,onChange:r=>D(r.target.value),placeholder:"Device/component name",className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Part Number"}),e.jsx("input",{type:"text",value:t,onChange:r=>d(r.target.value),placeholder:"e.g., CM-SENS-200",className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Revision"}),e.jsx("input",{type:"text",value:o,onChange:r=>x(r.target.value),placeholder:"e.g., A",className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:P,onChange:r=>u(r.target.value),placeholder:"Brief description of the DUT",className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Software Version"}),e.jsx("input",{type:"text",value:B,onChange:r=>O(r.target.value),placeholder:"e.g., FW 2.1.0",className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wide",children:"Requirements & Standards"}),e.jsxs("button",{onClick:ie,className:"flex items-center gap-1 px-2 py-1 text-xs bg-primary-100 text-primary-700 rounded hover:bg-primary-200",children:[e.jsx(H,{className:"w-3 h-3"})," Add Requirement"]})]}),h.length===0?e.jsx("p",{className:"text-sm text-gray-400 italic",children:'No requirements added yet. Click "Add Requirement" to begin.'}):e.jsx("div",{className:"space-y-3",children:h.map((r,l)=>e.jsxs("div",{className:"p-3 bg-surface-50 rounded-lg border border-surface-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-mono text-gray-500",children:r.requirementId}),e.jsx("button",{onClick:()=>a(h.filter((i,n)=>n!==l)),className:"text-red-500 hover:text-red-700",children:e.jsx(F,{className:"w-3.5 h-3.5"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"col-span-2",children:e.jsx("input",{type:"text",placeholder:"Requirement description",value:r.description,onChange:i=>{const n=[...h];n[l]={...r,description:i.target.value},a(n)},className:"w-full px-3 py-1.5 border border-surface-200 rounded text-sm"})}),e.jsxs("select",{value:r.category,onChange:i=>{const n=[...h];n[l]={...r,category:i.target.value},a(n)},className:"px-3 py-1.5 border border-surface-200 rounded text-sm",children:[e.jsx("option",{value:"Performance",children:"Performance"}),e.jsx("option",{value:"Safety",children:"Safety"}),e.jsx("option",{value:"Functional",children:"Functional"}),e.jsx("option",{value:"Regulatory",children:"Regulatory"}),e.jsx("option",{value:"User Need",children:"User Need"}),e.jsx("option",{value:"Environmental",children:"Environmental"})]}),e.jsxs("select",{value:r.verificationMethod,onChange:i=>{const n=[...h];n[l]={...r,verificationMethod:i.target.value},a(n)},className:"px-3 py-1.5 border border-surface-200 rounded text-sm",children:[e.jsx("option",{value:"Test",children:"Test"}),e.jsx("option",{value:"Inspection",children:"Inspection"}),e.jsx("option",{value:"Analysis",children:"Analysis"}),e.jsx("option",{value:"Demonstration",children:"Demonstration"})]}),e.jsx("div",{className:"col-span-2",children:e.jsx("input",{type:"text",placeholder:"Acceptance criteria",value:r.acceptanceCriteria,onChange:i=>{const n=[...h];n[l]={...r,acceptanceCriteria:i.target.value},a(n)},className:"w-full px-3 py-1.5 border border-surface-200 rounded text-sm"})})]})]},r.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wide",children:"Test Methods & Setup"}),e.jsxs("button",{onClick:le,className:"flex items-center gap-1 px-2 py-1 text-xs bg-primary-100 text-primary-700 rounded hover:bg-primary-200",children:[e.jsx(H,{className:"w-3 h-3"})," Add Test Method"]})]}),m.length===0?e.jsx("p",{className:"text-sm text-gray-400 italic",children:"No test methods added yet."}):e.jsx("div",{className:"space-y-3",children:m.map((r,l)=>e.jsxs("div",{className:"p-3 bg-surface-50 rounded-lg border border-surface-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-mono text-gray-500",children:r.testMethodId}),e.jsx("button",{onClick:()=>N(m.filter((i,n)=>n!==l)),className:"text-red-500 hover:text-red-700",children:e.jsx(F,{className:"w-3.5 h-3.5"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Test title",value:r.title,onChange:i=>{const n=[...m];n[l]={...r,title:i.target.value},N(n)},className:"px-3 py-1.5 border border-surface-200 rounded text-sm"}),e.jsx("select",{value:r.type,onChange:i=>{const n=[...m];n[l]={...r,type:i.target.value},N(n)},className:"px-3 py-1.5 border border-surface-200 rounded text-sm",children:["Functional","Environmental","Mechanical","Electrical","Software","Biocompatibility","Sterilization","Usability","EMC","Other"].map(i=>e.jsx("option",{value:i,children:i},i))}),e.jsx("div",{className:"col-span-2",children:e.jsx("input",{type:"text",placeholder:"Equipment (comma-separated)",value:r.equipment,onChange:i=>{const n=[...m];n[l]={...r,equipment:i.target.value},N(n)},className:"w-full px-3 py-1.5 border border-surface-200 rounded text-sm"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("textarea",{placeholder:"Procedure",value:r.procedure,rows:2,onChange:i=>{const n=[...m];n[l]={...r,procedure:i.target.value},N(n)},className:"w-full px-3 py-1.5 border border-surface-200 rounded text-sm"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("input",{type:"text",placeholder:"Acceptance criteria",value:r.acceptanceCriteria,onChange:i=>{const n=[...m];n[l]={...r,acceptanceCriteria:i.target.value},N(n)},className:"w-full px-3 py-1.5 border border-surface-200 rounded text-sm"})})]})]},r.id))})]}),h.length>0&&m.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wide",children:"Test Results & Data"}),e.jsxs("button",{onClick:de,className:"flex items-center gap-1 px-2 py-1 text-xs bg-primary-100 text-primary-700 rounded hover:bg-primary-200",children:[e.jsx(H,{className:"w-3 h-3"})," Add Result"]})]}),p.length===0?e.jsx("p",{className:"text-sm text-gray-400 italic",children:"No test results recorded yet."}):e.jsx("div",{className:"space-y-3",children:p.map((r,l)=>e.jsxs("div",{className:"p-3 bg-surface-50 rounded-lg border border-surface-200",children:[e.jsx("div",{className:"flex items-center justify-end mb-2",children:e.jsx("button",{onClick:()=>b(p.filter((i,n)=>n!==l)),className:"text-red-500 hover:text-red-700",children:e.jsx(F,{className:"w-3.5 h-3.5"})})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[e.jsx("select",{value:r.testMethodId,onChange:i=>{const n=[...p];n[l]={...r,testMethodId:i.target.value},b(n)},className:"px-3 py-1.5 border border-surface-200 rounded text-sm",children:m.map(i=>e.jsxs("option",{value:i.id,children:[i.testMethodId," - ",i.title]},i.id))}),e.jsx("select",{value:r.requirementId,onChange:i=>{const n=[...p];n[l]={...r,requirementId:i.target.value},b(n)},className:"px-3 py-1.5 border border-surface-200 rounded text-sm",children:h.map(i=>e.jsx("option",{value:i.id,children:i.requirementId},i.id))}),e.jsxs("select",{value:r.outcome,onChange:i=>{const n=[...p];n[l]={...r,outcome:i.target.value},b(n)},className:"px-3 py-1.5 border border-surface-200 rounded text-sm",children:[e.jsx("option",{value:"Pass",children:"Pass"}),e.jsx("option",{value:"Fail",children:"Fail"}),e.jsx("option",{value:"Conditional Pass",children:"Conditional Pass"}),e.jsx("option",{value:"Not Tested",children:"Not Tested"}),e.jsx("option",{value:"In Progress",children:"In Progress"})]}),e.jsx("input",{type:"text",placeholder:"Measured value",value:r.measuredValue,onChange:i=>{const n=[...p];n[l]={...r,measuredValue:i.target.value},b(n)},className:"px-3 py-1.5 border border-surface-200 rounded text-sm"}),e.jsx("input",{type:"text",placeholder:"Tested by",value:r.testedBy,onChange:i=>{const n=[...p];n[l]={...r,testedBy:i.target.value},b(n)},className:"px-3 py-1.5 border border-surface-200 rounded text-sm"}),e.jsx("input",{type:"text",placeholder:"Notes",value:r.notes,onChange:i=>{const n=[...p];n[l]={...r,notes:i.target.value},b(n)},className:"px-3 py-1.5 border border-surface-200 rounded text-sm"})]})]},r.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3 uppercase tracking-wide",children:"Conclusion & Discussion"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Overall Conclusion"}),e.jsxs("select",{value:M,onChange:r=>ae(r.target.value),className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm",children:[e.jsx("option",{value:"Pass",children:"Pass"}),e.jsx("option",{value:"Fail",children:"Fail"}),e.jsx("option",{value:"Conditional Pass",children:"Conditional Pass"}),e.jsx("option",{value:"Not Tested",children:"Not Tested"}),e.jsx("option",{value:"In Progress",children:"In Progress"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Conclusion Summary"}),e.jsx("textarea",{value:Y,onChange:r=>re(r.target.value),rows:3,placeholder:"Summarize the overall pass/fail conclusion...",className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Non-Conformances"}),e.jsx("button",{onClick:()=>_([...E,""]),className:"text-xs text-primary-600 hover:text-primary-700",children:"+ Add"})]}),E.map((r,l)=>e.jsxs("div",{className:"flex gap-2 mb-1",children:[e.jsx("input",{type:"text",value:r,onChange:i=>{const n=[...E];n[l]=i.target.value,_(n)},placeholder:"Describe non-conformance...",className:"flex-1 px-3 py-1.5 border border-surface-200 rounded text-sm"}),e.jsx("button",{onClick:()=>_(E.filter((i,n)=>n!==l)),className:"text-red-500 hover:text-red-700",children:e.jsx(F,{className:"w-3.5 h-3.5"})})]},l))]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Design Change Recommendations"}),e.jsx("button",{onClick:()=>G([...U,""]),className:"text-xs text-primary-600 hover:text-primary-700",children:"+ Add"})]}),U.map((r,l)=>e.jsxs("div",{className:"flex gap-2 mb-1",children:[e.jsx("input",{type:"text",value:r,onChange:i=>{const n=[...U];n[l]=i.target.value,G(n)},placeholder:"Describe recommendation...",className:"flex-1 px-3 py-1.5 border border-surface-200 rounded text-sm"}),e.jsx("button",{onClick:()=>G(U.filter((i,n)=>n!==l)),className:"text-red-500 hover:text-red-700",children:e.jsx(F,{className:"w-3.5 h-3.5"})})]},l))]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discussion Notes"}),e.jsx("textarea",{value:Z,onChange:r=>ne(r.target.value),rows:3,placeholder:"Additional discussion, analysis, and observations...",className:"w-full px-3 py-2 border border-surface-200 rounded-lg text-sm"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-surface-200",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-sm text-gray-600 hover:bg-surface-100 rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:ce,disabled:!w||!v||!I||!C,className:"px-4 py-2 text-sm bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Create Report"})]})]})})}function L(s){switch(s){case"Pass":return"bg-green-100 text-green-700";case"Fail":return"bg-red-100 text-red-700";case"Conditional Pass":return"bg-yellow-100 text-yellow-700";case"In Progress":return"bg-blue-100 text-blue-700";case"Not Tested":return"bg-gray-100 text-gray-500";default:return"bg-gray-100 text-gray-500"}}function be(s){switch(s){case"Pass":return e.jsx(J,{className:"w-4 h-4 text-green-600"});case"Fail":return e.jsx($,{className:"w-4 h-4 text-red-600"});case"Conditional Pass":return e.jsx(K,{className:"w-4 h-4 text-yellow-600"});case"In Progress":return e.jsx(Q,{className:"w-4 h-4 text-blue-600"});default:return e.jsx(Q,{className:"w-4 h-4 text-gray-400"})}}function fe(s){switch(s){case"Draft":return"bg-gray-100 text-gray-700";case"In Progress":return"bg-blue-100 text-blue-700";case"Under Review":return"bg-yellow-100 text-yellow-700";case"Approved":return"bg-green-100 text-green-700";case"Rejected":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}}function je({report:s,isOpen:A,onClose:f}){const[j,y]=c.useState("overview");if(!A)return null;const q=s.testResults.filter(t=>t.outcome==="Pass").length,w=s.testResults.filter(t=>t.outcome==="Fail").length,k=s.testResults.filter(t=>t.outcome==="Conditional Pass").length,v=s.testResults.filter(t=>t.outcome==="Not Tested").length,V=s.testResults.filter(t=>t.outcome==="In Progress").length,T=s.requirements.map(t=>{const d=s.testResults.filter(o=>o.requirementId===t.id);return{requirement:t,methodResults:s.testMethods.map(o=>{const x=d.find(P=>P.testMethodId===o.id);return{testMethod:o,result:x}})}}),R=s.requirements.filter(t=>s.testResults.some(d=>d.requirementId===t.id&&d.outcome!=="Not Tested")).length,C=s.requirements.length>0?R/s.requirements.length*100:0,S=()=>{window.print()},I=()=>{const t=JSON.stringify(s,null,2),d=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(d),x=document.createElement("a");x.href=o,x.download=`${s.reportNumber}.json`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(o)},D=[{id:"overview",label:"Overview"},{id:"requirements",label:"Requirements"},{id:"methods",label:"Test Methods"},{id:"results",label:"Results"},{id:"traceability",label:"Traceability Matrix"},{id:"discussion",label:"Discussion"}];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 print:bg-white print:static",onClick:f,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl mx-4 max-h-[90vh] flex flex-col print:max-w-none print:max-h-none print:shadow-none print:rounded-none",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-surface-200 print:border-b-2 print:border-gray-300",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{className:"w-6 h-6 text-primary-600"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:s.reportNumber}),e.jsx("span",{className:g("px-2 py-0.5 text-xs font-medium rounded-full",fe(s.status)),children:s.status})]}),e.jsx("p",{className:"text-sm text-gray-500",children:s.title})]})]}),e.jsxs("div",{className:"flex items-center gap-2 print:hidden",children:[e.jsxs("button",{onClick:S,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-600 hover:bg-surface-100 rounded-md transition-colors",children:[e.jsx(oe,{className:"w-4 h-4"})," Print"]}),e.jsxs("button",{onClick:I,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-600 hover:bg-surface-100 rounded-md transition-colors",children:[e.jsx(me,{className:"w-4 h-4"})," Export JSON"]}),e.jsx("button",{onClick:f,className:"p-1.5 hover:bg-surface-100 rounded-md",children:e.jsx(se,{className:"w-5 h-5 text-gray-500"})})]})]}),e.jsx("div",{className:"flex gap-1 px-4 pt-3 border-b border-surface-200 print:hidden",children:D.map(t=>e.jsx("button",{onClick:()=>y(t.id),className:g("px-4 py-2 text-sm font-medium rounded-t-lg transition-colors border-b-2 -mb-px",j===t.id?"border-primary-600 text-primary-700 bg-primary-50":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-surface-50"),children:t.label},t.id))}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 print:overflow-visible",children:[j==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Type"}),e.jsx("p",{className:"font-medium",children:s.type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Category"}),e.jsx("p",{className:"font-medium",children:s.category})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Version"}),e.jsxs("p",{className:"font-medium",children:["v",s.version]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Author"}),e.jsx("p",{className:"font-medium",children:s.author})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Created"}),e.jsx("p",{className:"font-medium",children:z(s.createdAt)})]}),s.approvedAt&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Approved"}),e.jsxs("p",{className:"font-medium",children:[z(s.approvedAt)," by ",s.approvedBy]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Objective / Purpose"}),e.jsx("p",{className:"text-sm text-gray-600 bg-surface-50 p-4 rounded-lg",children:s.objective})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Device Under Test (DUT)"}),e.jsxs("div",{className:"bg-surface-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Name"}),e.jsx("p",{className:"font-medium",children:s.deviceUnderTest.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Part Number"}),e.jsx("p",{className:"font-medium",children:s.deviceUnderTest.partNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Revision"}),e.jsx("p",{className:"font-medium",children:s.deviceUnderTest.revision})]}),s.deviceUnderTest.softwareVersion&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Software Version"}),e.jsx("p",{className:"font-medium",children:s.deviceUnderTest.softwareVersion})]}),s.deviceUnderTest.serialNumbers&&s.deviceUnderTest.serialNumbers.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Serial Numbers"}),e.jsx("p",{className:"font-medium",children:s.deviceUnderTest.serialNumbers.join(", ")})]})]}),s.deviceUnderTest.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-3 pt-3 border-t border-surface-200",children:s.deviceUnderTest.description})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Overall Conclusion"}),e.jsxs("div",{className:g("p-4 rounded-lg flex items-center gap-3",L(s.overallConclusion)),children:[be(s.overallConclusion),e.jsx("span",{className:"text-lg font-bold",children:s.overallConclusion})]}),s.conclusionSummary&&e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:s.conclusionSummary})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Test Results Summary"}),e.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-700",children:q}),e.jsx("p",{className:"text-xs text-green-600",children:"Pass"})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-700",children:w}),e.jsx("p",{className:"text-xs text-red-600",children:"Fail"})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:k}),e.jsx("p",{className:"text-xs text-yellow-600",children:"Conditional"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:V}),e.jsx("p",{className:"text-xs text-blue-600",children:"In Progress"})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-700",children:v}),e.jsx("p",{className:"text-xs text-gray-600",children:"Not Tested"})]})]})]})]}),j==="requirements"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:["Design Requirements (",s.requirements.length,")"]}),s.requirements.length===0?e.jsx("p",{className:"text-sm text-gray-400 italic",children:"No requirements defined."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-surface-50 border-b border-surface-200",children:[e.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Req ID"}),e.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Description"}),e.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Category"}),e.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Acceptance Criteria"}),e.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Method"})]})}),e.jsx("tbody",{children:s.requirements.map(t=>e.jsxs("tr",{className:"border-b border-surface-100 hover:bg-surface-50",children:[e.jsx("td",{className:"px-3 py-2 font-mono text-xs",children:t.requirementId}),e.jsx("td",{className:"px-3 py-2",children:t.description}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:"px-2 py-0.5 bg-surface-100 rounded text-xs",children:t.category})}),e.jsx("td",{className:"px-3 py-2 text-gray-600",children:t.acceptanceCriteria}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs",children:t.verificationMethod})})]},t.id))})]})})]}),j==="methods"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:["Test Methods (",s.testMethods.length,")"]}),s.testMethods.length===0?e.jsx("p",{className:"text-sm text-gray-400 italic",children:"No test methods defined."}):e.jsx("div",{className:"space-y-4",children:s.testMethods.map(t=>e.jsxs("div",{className:"bg-surface-50 rounded-lg p-4 border border-surface-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-mono text-xs text-gray-500",children:t.testMethodId}),e.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs",children:t.type})]}),e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:t.title}),t.equipment.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Equipment"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.equipment.map((d,o)=>e.jsx("span",{className:"px-2 py-0.5 bg-white border border-surface-200 rounded text-xs",children:d},o))})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Procedure"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.procedure})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Acceptance Criteria"}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:t.acceptanceCriteria})]}),t.environmentalConditions&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Environmental Conditions"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.environmentalConditions})]})]},t.id))})]}),j==="results"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:["Test Results (",s.testResults.length,")"]}),s.testResults.length===0?e.jsx("p",{className:"text-sm text-gray-400 italic",children:"No test results recorded."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-surface-50 border-b border-surface-200",children:[e.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Test Method"}),e.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Requirement"}),e.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Measured Value"}),e.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Criteria"}),e.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Outcome"}),e.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Tester"}),e.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Date"})]})}),e.jsx("tbody",{children:s.testResults.map(t=>{const d=s.testMethods.find(x=>x.id===t.testMethodId),o=s.requirements.find(x=>x.id===t.requirementId);return e.jsxs("tr",{className:"border-b border-surface-100 hover:bg-surface-50",children:[e.jsx("td",{className:"px-3 py-2 font-mono text-xs",children:d?.testMethodId||"-"}),e.jsx("td",{className:"px-3 py-2 font-mono text-xs",children:o?.requirementId||"-"}),e.jsxs("td",{className:"px-3 py-2",children:[t.measuredValue||"-"," ",t.unit||""]}),e.jsx("td",{className:"px-3 py-2 text-gray-600 text-xs",children:t.acceptanceCriteria}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:g("inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium",L(t.outcome)),children:t.outcome})}),e.jsx("td",{className:"px-3 py-2",children:t.testedBy}),e.jsx("td",{className:"px-3 py-2 text-xs",children:z(t.testedAt)})]},t.id)})})]})}),s.testResults.some(t=>t.notes)&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("div",{className:"space-y-2",children:s.testResults.filter(t=>t.notes).map(t=>{const d=s.testMethods.find(o=>o.id===t.testMethodId);return e.jsxs("div",{className:"bg-surface-50 p-3 rounded text-sm",children:[e.jsxs("span",{className:"font-mono text-xs text-gray-500",children:[d?.testMethodId,":"]})," ",e.jsx("span",{className:"text-gray-600",children:t.notes})]},t.id)})})]})]}),j==="traceability"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Requirements Traceability Matrix (DVP&R)"}),e.jsxs("span",{className:g("px-3 py-1 rounded-full text-xs font-medium",C===100?"bg-green-100 text-green-700":C>=75?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:["Coverage: ",C.toFixed(0),"% (",R,"/",s.requirements.length,")"]})]}),s.requirements.length===0||s.testMethods.length===0?e.jsx("p",{className:"text-sm text-gray-400 italic",children:"Requirements and test methods must be defined to generate the traceability matrix."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm border border-surface-200",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-surface-50",children:[e.jsx("th",{className:"sticky left-0 bg-surface-50 z-10 text-left px-3 py-2 font-medium text-gray-700 border-b border-r border-surface-200 min-w-[200px]",children:"Requirement"}),s.testMethods.map(t=>e.jsxs("th",{className:"text-center px-3 py-2 font-medium text-gray-700 border-b border-surface-200 whitespace-nowrap min-w-[80px]",children:[e.jsx("div",{className:"text-xs font-mono",children:t.testMethodId}),e.jsx("div",{className:"text-[10px] text-gray-400 font-normal truncate max-w-[100px]",children:t.title})]},t.id)),e.jsx("th",{className:"text-center px-3 py-2 font-medium text-gray-700 border-b border-l border-surface-200",children:"Status"})]})}),e.jsx("tbody",{children:T.map(t=>{const d=s.testResults.filter(u=>u.requirementId===t.requirement.id),o=d.length>0&&d.every(u=>u.outcome==="Pass"),x=d.some(u=>u.outcome==="Fail"),P=d.length===0?"Not Tested":x?"Fail":o?"Pass":"In Progress";return e.jsxs("tr",{className:"border-b border-surface-100 hover:bg-surface-50",children:[e.jsxs("td",{className:"sticky left-0 bg-white z-10 px-3 py-2 border-r border-surface-200",children:[e.jsx("div",{className:"font-mono text-xs text-gray-500",children:t.requirement.requirementId}),e.jsx("div",{className:"text-xs text-gray-700 truncate max-w-[250px]",children:t.requirement.description})]}),t.methodResults.map(u=>e.jsx("td",{className:"text-center px-3 py-2 border-surface-100",children:u.result?e.jsx("span",{className:g("inline-flex items-center justify-center w-8 h-8 rounded-full text-xs font-bold",L(u.result.outcome)),children:u.result.outcome==="Pass"?"P":u.result.outcome==="Fail"?"F":u.result.outcome==="Conditional Pass"?"C":u.result.outcome==="In Progress"?"...":"-"}):e.jsx("span",{className:"text-gray-300",children:"—"})},u.testMethod.id)),e.jsx("td",{className:"text-center px-3 py-2 border-l border-surface-200",children:e.jsx("span",{className:g("inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium",L(P)),children:P})})]},t.requirement.id)})})]})}),e.jsxs("div",{className:"flex items-center gap-4 mt-4 text-xs text-gray-500",children:[e.jsx("span",{className:"font-medium",children:"Legend:"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-green-100 text-green-700 flex items-center justify-center text-[10px] font-bold",children:"P"})," Pass"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-red-100 text-red-700 flex items-center justify-center text-[10px] font-bold",children:"F"})," Fail"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-yellow-100 text-yellow-700 flex items-center justify-center text-[10px] font-bold",children:"C"})," Conditional"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center text-[10px] font-bold",children:".."})," In Progress"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-300",children:"—"})," Not mapped"]})]})]}),j==="discussion"&&e.jsxs("div",{className:"space-y-6",children:[s.nonConformances.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4 text-red-500"})," Non-Conformances (",s.nonConformances.length,")"]}),e.jsx("ul",{className:"space-y-2",children:s.nonConformances.map((t,d)=>e.jsx("li",{className:"text-sm text-gray-600 bg-red-50 border border-red-200 rounded-lg p-3",children:t},d))})]}),s.failures.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4 text-orange-500"})," Failures (",s.failures.length,")"]}),e.jsx("ul",{className:"space-y-2",children:s.failures.map((t,d)=>e.jsx("li",{className:"text-sm text-gray-600 bg-orange-50 border border-orange-200 rounded-lg p-3",children:t},d))})]}),s.designChangeRecommendations.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 text-blue-500"})," Design Change Recommendations (",s.designChangeRecommendations.length,")"]}),e.jsx("ul",{className:"space-y-2",children:s.designChangeRecommendations.map((t,d)=>e.jsx("li",{className:"text-sm text-gray-600 bg-blue-50 border border-blue-200 rounded-lg p-3",children:t},d))})]}),s.discussionNotes&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Discussion Notes"}),e.jsx("p",{className:"text-sm text-gray-600 bg-surface-50 p-4 rounded-lg whitespace-pre-wrap",children:s.discussionNotes})]}),(s.linkedNCRs.length>0||s.linkedCAPAs.length>0||s.linkedChangeControls.length>0)&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Linked Entities"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[s.linkedNCRs.length>0&&e.jsxs("div",{className:"bg-surface-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Linked NCRs"}),s.linkedNCRs.map(t=>e.jsx("p",{className:"font-mono text-xs",children:t.substring(0,8)},t))]}),s.linkedCAPAs.length>0&&e.jsxs("div",{className:"bg-surface-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Linked CAPAs"}),s.linkedCAPAs.map(t=>e.jsx("p",{className:"font-mono text-xs",children:t.substring(0,8)},t))]}),s.linkedChangeControls.length>0&&e.jsxs("div",{className:"bg-surface-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Linked Change Controls"}),s.linkedChangeControls.map(t=>e.jsx("p",{className:"font-mono text-xs",children:t.substring(0,8)},t))]})]})]}),s.isoReferences.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"ISO References"}),e.jsx("div",{className:"space-y-1",children:s.isoReferences.map((t,d)=>e.jsxs("div",{className:"flex gap-2 text-sm",children:[e.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs font-medium",children:[t.standard,":",t.clause]}),e.jsx("span",{className:"text-gray-600",children:t.description})]},d))})]}),s.nonConformances.length===0&&s.failures.length===0&&s.designChangeRecommendations.length===0&&!s.discussionNotes&&e.jsx("p",{className:"text-sm text-gray-400 italic",children:"No discussion items recorded."})]})]})]})})}const ye=[{reportNumber:"EVT-2026-001",title:"Cardiac Monitor Sensor Module - Engineering Validation",type:"EVT",category:"Verification",status:"Approved",version:"1.0",author:"Paul Moore",reviewers:["Katie Emma"],approvers:["Katie Emma"],objective:"Verify that the cardiac monitor sensor module meets all design specifications for signal acquisition accuracy, power consumption, and electromagnetic compatibility prior to DVT phase.",deviceUnderTest:{name:"Cardiac Monitor Sensor Module",partNumber:"CM-SENS-200",revision:"B",serialNumbers:["SN-001","SN-002","SN-003"],description:"Analog front-end sensor module for continuous cardiac rhythm monitoring. Interfaces with main processing board via SPI.",softwareVersion:"FW 2.1.0"},testMethods:[{id:"tm-1",testMethodId:"TM-001",title:"Signal Accuracy Test",description:"Verify ECG signal acquisition accuracy against reference standard.",type:"Electrical",equipment:["Fluke ProSim 8","Keysight DSOX3024T Oscilloscope"],procedure:"Apply known ECG waveforms via simulator. Measure output signal and compare to input reference.",acceptanceCriteria:"Signal accuracy within +/- 5% of reference at all standard gain settings",isoReferences:[{standard:"IEC 60601-2-47",clause:"201.12.1",description:"Basic safety and essential performance"}]},{id:"tm-2",testMethodId:"TM-002",title:"Power Consumption Test",description:"Measure power consumption across operating modes.",type:"Electrical",equipment:["Keithley DMM7510 Multimeter"],procedure:"Measure current draw in active, standby, and sleep modes under nominal supply voltage.",acceptanceCriteria:"Active mode < 50mA, Standby < 5mA, Sleep < 100uA at 3.3V",isoReferences:[]},{id:"tm-3",testMethodId:"TM-003",title:"EMC Pre-Compliance Screening",description:"Conducted and radiated emissions pre-compliance screening.",type:"EMC",equipment:["Near-field probe set","Spectrum analyzer"],procedure:"Perform conducted and radiated emissions screening per IEC 61000-4-3 methodology.",acceptanceCriteria:"No emissions exceeding CISPR 11 Group 1 Class B limits with 6dB margin",environmentalConditions:"23C +/- 5C, 45-75% RH",isoReferences:[{standard:"IEC 60601-1-2",clause:"7",description:"EMC requirements"}]}],requirements:[{id:"req-1",requirementId:"REQ-101",description:"ECG signal accuracy shall be within +/- 5% of reference standard",category:"Performance",source:"Product Requirements Document PRD-CM-001",acceptanceCriteria:"+/- 5% accuracy across all gain settings",verificationMethod:"Test",isoReferences:[{standard:"ISO 13485",clause:"7.3.4",description:"Design and development review"}]},{id:"req-2",requirementId:"REQ-102",description:"Power consumption shall not exceed 50mA in active mode",category:"Performance",source:"System Requirements SRS-CM-001",acceptanceCriteria:"< 50mA active, < 5mA standby, < 100uA sleep",verificationMethod:"Test",isoReferences:[]},{id:"req-3",requirementId:"REQ-201",description:"Device shall comply with CISPR 11 Class B emissions limits",category:"Regulatory",source:"IEC 60601-1-2:2014",acceptanceCriteria:"All emissions below Class B limits with 6dB margin",verificationMethod:"Test",isoReferences:[{standard:"IEC 60601-1-2",clause:"7",description:"EMC requirements"}]}],testResults:[{id:"tr-1",testMethodId:"tm-1",requirementId:"req-1",measuredValue:"3.2",unit:"% error",acceptanceCriteria:"+/- 5%",outcome:"Pass",testedBy:"Paul Moore",testedAt:new Date("2026-01-20"),notes:"All gain settings tested. Max error observed at highest gain."},{id:"tr-2",testMethodId:"tm-2",requirementId:"req-2",measuredValue:"42",unit:"mA",acceptanceCriteria:"< 50mA",outcome:"Pass",testedBy:"Paul Moore",testedAt:new Date("2026-01-21"),notes:"Standby: 3.8mA, Sleep: 78uA. All within spec."},{id:"tr-3",testMethodId:"tm-3",requirementId:"req-3",measuredValue:"See report",unit:"dBuV/m",acceptanceCriteria:"Class B with 6dB margin",outcome:"Conditional Pass",testedBy:"Paul Moore",testedAt:new Date("2026-01-22"),notes:"Minor exceedance at 230MHz. Within Class B limits but margin reduced to 3dB. Design change recommended."}],overallConclusion:"Conditional Pass",conclusionSummary:"The sensor module meets primary performance requirements for signal accuracy and power consumption. EMC pre-compliance screening identified a minor margin reduction at 230MHz that should be addressed before DVT. Recommend adding ferrite bead on SPI clock line.",nonConformances:["EMC margin reduction at 230MHz (3dB vs 6dB target)"],failures:[],designChangeRecommendations:["Add ferrite bead (BLM18PG221SN1) on SPI clock line to address 230MHz emission","Consider shielding improvement on sensor flex cable"],discussionNotes:"Overall positive results. The sensor module architecture is sound. Minor EMC issue is addressable with component-level changes that will not affect form factor or signal integrity.",linkedNCRs:[],linkedCAPAs:[],linkedChangeControls:[],linkedRiskAssessments:[],linkedDocuments:[],isoReferences:[{standard:"ISO 13485",clause:"7.3.6",description:"Design and development verification"},{standard:"ISO 13485",clause:"7.3.7",description:"Design and development validation"}],auditTrail:[],submittedAt:new Date("2026-01-25"),approvedAt:new Date("2026-01-28"),approvedBy:"Katie Emma"},{reportNumber:"DVT-2026-001",title:"Infusion Pump Housing Assembly - Design Validation",type:"DVT",category:"Validation",status:"In Progress",version:"0.2",author:"Paul Moore",reviewers:[],approvers:[],objective:"Validate that the infusion pump housing assembly meets user needs for drop resistance, ingress protection, and ergonomic handling under simulated clinical use conditions.",deviceUnderTest:{name:"Infusion Pump Housing Assembly",partNumber:"IP-HOUS-100",revision:"A",serialNumbers:["PROTO-01","PROTO-02"],description:"Injection-molded polycarbonate housing with IP54 sealing for portable infusion pump platform."},testMethods:[{id:"tm-4",testMethodId:"TM-010",title:"Drop Test",description:"1-meter drop test onto concrete surface from 6 orientations.",type:"Mechanical",equipment:["Drop test fixture","High-speed camera"],procedure:"Drop unit from 1m height onto concrete surface. Test all 6 faces, 4 edges, 4 corners (14 drops total).",acceptanceCriteria:"No cracking, no battery ejection, device powers on after all drops",isoReferences:[{standard:"IEC 60601-1",clause:"15.3.4",description:"Mechanical strength"}]},{id:"tm-5",testMethodId:"TM-011",title:"IP54 Ingress Protection Test",description:"Dust and water splash resistance verification.",type:"Environmental",equipment:["IP test chamber","Dust chamber"],procedure:"Per IEC 60529: Dust test (IP5X) followed by splash test (IPX4).",acceptanceCriteria:"No dust ingress affecting operation; no water ingress to internal components",isoReferences:[{standard:"IEC 60529",clause:"14",description:"Degrees of protection"}]}],requirements:[{id:"req-4",requirementId:"REQ-301",description:"Housing shall survive 1m drop to concrete without functional failure",category:"Safety",source:"User Needs Document UND-IP-001",acceptanceCriteria:"No cracking, battery retention, powers on after drop",verificationMethod:"Test",isoReferences:[{standard:"IEC 60601-1",clause:"15.3.4",description:"Mechanical strength"}]},{id:"req-5",requirementId:"REQ-302",description:"Housing shall provide IP54 protection rating",category:"Environmental",source:"User Needs Document UND-IP-001",acceptanceCriteria:"Meets IEC 60529 IP54 requirements",verificationMethod:"Test",isoReferences:[]}],testResults:[{id:"tr-4",testMethodId:"tm-4",requirementId:"req-4",measuredValue:"See detailed report",unit:"",acceptanceCriteria:"No functional failure",outcome:"Pass",testedBy:"Paul Moore",testedAt:new Date("2026-01-30"),notes:"Minor cosmetic mark on corner drop #3. No functional impact."},{id:"tr-5",testMethodId:"tm-5",requirementId:"req-5",outcome:"In Progress",acceptanceCriteria:"IP54 per IEC 60529",testedBy:"Paul Moore",testedAt:new Date("2026-02-01"),notes:"Dust test complete (pass). Water splash test scheduled Feb 3."}],overallConclusion:"In Progress",conclusionSummary:"Drop testing complete with positive results. IP testing partially complete - awaiting water splash test results.",nonConformances:[],failures:[],designChangeRecommendations:[],discussionNotes:"Drop test results are encouraging. Housing integrity maintained across all orientations. Awaiting completion of IP54 water splash testing.",linkedNCRs:[],linkedCAPAs:[],linkedChangeControls:[],linkedRiskAssessments:[],linkedDocuments:[],isoReferences:[{standard:"ISO 13485",clause:"7.3.7",description:"Design and development validation"}],auditTrail:[]}];function Ne(s){switch(s){case"Draft":return"bg-gray-100 text-gray-700";case"In Progress":return"bg-blue-100 text-blue-700";case"Under Review":return"bg-yellow-100 text-yellow-700";case"Approved":return"bg-green-100 text-green-700";case"Rejected":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}}function ve(s){switch(s){case"EVT":return"bg-purple-100 text-purple-700";case"DVT":return"bg-indigo-100 text-indigo-700";case"PVT":return"bg-teal-100 text-teal-700";case"DVP&R":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}}function Ce(s){switch(s){case"Pass":return e.jsx(J,{className:"w-4 h-4 text-green-600"});case"Fail":return e.jsx($,{className:"w-4 h-4 text-red-600"});case"Conditional Pass":return e.jsx(K,{className:"w-4 h-4 text-yellow-600"});case"In Progress":return e.jsx(Q,{className:"w-4 h-4 text-blue-600"});default:return e.jsx(Q,{className:"w-4 h-4 text-gray-400"})}}function Se(){const{validationReports:s,addValidationReport:A,updateValidationReport:f,getValidationStats:j}=ee(),y=j(),[q,w]=c.useState(!1),[k,v]=c.useState(!1),[V,T]=c.useState(null),[R,C]=c.useState(""),[S,I]=c.useState("all"),[D,t]=c.useState("all"),[d,o]=c.useState("all"),[x,P]=c.useState(null),[u,B]=c.useState(!1);!u&&s.length===0&&(ye.forEach(a=>A(a)),B(!0));const O=s.filter(a=>{const m=a.title.toLowerCase().includes(R.toLowerCase())||a.reportNumber.toLowerCase().includes(R.toLowerCase())||a.deviceUnderTest.name.toLowerCase().includes(R.toLowerCase()),N=S==="all"||a.status===S,p=D==="all"||a.type===D,b=d==="all"||a.category===d;return m&&N&&p&&b}),h=a=>{T(a),v(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(W,{className:"w-7 h-7 text-primary-600"}),"Engineering Validation Reports"]}),e.jsx("p",{className:"text-gray-500 mt-1",children:"EVT/DVT/PVT reports and DVP&R traceability management"})]}),e.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx(H,{className:"w-4 h-4"}),"New Report"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-surface-200 p-4",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Reports"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:y.total})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-surface-200 p-4",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"In Progress"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:y.inProgress})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-surface-200 p-4",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Approved"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:y.approved})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-surface-200 p-4",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Pass Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-primary-600",children:[y.passRate.toFixed(0),"%"]})]})]}),e.jsx("div",{className:"flex gap-2",children:["all","Verification","Validation"].map(a=>e.jsxs("button",{onClick:()=>o(a),className:g("px-4 py-2 text-sm rounded-lg transition-colors",d===a?"bg-primary-100 text-primary-700 font-medium":"bg-surface-100 text-gray-600 hover:bg-surface-200"),children:[a==="all"?"All Reports":a,a==="Verification"&&e.jsx("span",{className:"ml-2 text-xs text-gray-400",children:'"Did I build it right?"'}),a==="Validation"&&e.jsx("span",{className:"ml-2 text-xs text-gray-400",children:'"Did I build the right thing?"'})]},a))}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search reports...",value:R,onChange:a=>C(a.target.value),className:"w-full pl-10 pr-4 py-2 bg-white border border-surface-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsx("div",{className:"flex gap-1",children:["all","EVT","DVT","PVT","DVP&R"].map(a=>e.jsx("button",{onClick:()=>t(a),className:g("px-3 py-1.5 text-xs rounded-md transition-colors",D===a?"bg-primary-100 text-primary-700 font-medium":"bg-surface-100 text-gray-600 hover:bg-surface-200"),children:a==="all"?"All Types":a},a))}),e.jsx("div",{className:"flex gap-1",children:["all","Draft","In Progress","Under Review","Approved","Rejected"].map(a=>e.jsx("button",{onClick:()=>I(a),className:g("px-3 py-1.5 text-xs rounded-md transition-colors",S===a?"bg-primary-100 text-primary-700 font-medium":"bg-surface-100 text-gray-600 hover:bg-surface-200"),children:a==="all"?"All":a},a))})]}),e.jsx("div",{className:"space-y-3",children:O.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-surface-200 p-12 text-center",children:[e.jsx(W,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No validation reports found"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create a new report to get started"})]}):O.map(a=>{const m=x===a.id,N=a.testResults.filter(M=>M.outcome==="Pass").length,p=a.testResults.filter(M=>M.outcome==="Fail").length,b=a.testResults.filter(M=>M.outcome==="Conditional Pass").length;return e.jsxs("div",{className:"bg-white rounded-lg border border-surface-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>P(m?null:a.id),className:"w-full flex items-center gap-4 p-4 text-left hover:bg-surface-50 transition-colors",children:[m?e.jsx(ue,{className:"w-4 h-4 text-gray-400"}):e.jsx(he,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("span",{className:"font-mono text-xs text-gray-500",children:a.reportNumber}),e.jsx("span",{className:g("px-2 py-0.5 text-xs font-medium rounded-full",ve(a.type)),children:a.type}),e.jsx("span",{className:g("px-2 py-0.5 text-xs font-medium rounded-full",a.category==="Verification"?"bg-cyan-100 text-cyan-700":"bg-amber-100 text-amber-700"),children:a.category}),e.jsx("span",{className:g("px-2 py-0.5 text-xs font-medium rounded-full",Ne(a.status)),children:a.status})]}),e.jsx("p",{className:"font-medium text-gray-900 truncate",children:a.title}),e.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:["DUT: ",a.deviceUnderTest.name," (",a.deviceUnderTest.partNumber," Rev ",a.deviceUnderTest.revision,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Ce(a.overallConclusion),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:a.overallConclusion})]})]}),m&&e.jsxs("div",{className:"border-t border-surface-200 p-4 bg-surface-50 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Author"}),e.jsx("p",{className:"font-medium",children:a.author})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Created"}),e.jsx("p",{className:"font-medium",children:z(a.createdAt)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Version"}),e.jsxs("p",{className:"font-medium",children:["v",a.version]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Objective"}),e.jsx("p",{className:"text-sm text-gray-600",children:a.objective})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Test Results Summary"}),e.jsxs("div",{className:"flex gap-3 text-sm",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded",children:[e.jsx(J,{className:"w-3 h-3"})," Pass: ",N]}),e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-700 rounded",children:[e.jsx($,{className:"w-3 h-3"})," Fail: ",p]}),e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-700 rounded",children:[e.jsx(K,{className:"w-3 h-3"})," Conditional: ",b]}),e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-600 rounded",children:["Total: ",a.testResults.length]})]})]}),a.conclusionSummary&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Conclusion"}),e.jsx("p",{className:"text-sm text-gray-600",children:a.conclusionSummary})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-surface-200",children:[e.jsxs("button",{onClick:()=>h(a),className:"flex items-center gap-1.5 px-3 py-1.5 bg-primary-600 text-white text-sm rounded-md hover:bg-primary-700 transition-colors",children:[e.jsx(pe,{className:"w-3.5 h-3.5"}),"View Full Report"]}),a.status==="Draft"&&e.jsx("button",{onClick:()=>f(a.id,{status:"In Progress"}),className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Begin Testing"}),a.status==="In Progress"&&e.jsx("button",{onClick:()=>f(a.id,{status:"Under Review",submittedAt:new Date}),className:"px-3 py-1.5 text-sm bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors",children:"Submit for Review"}),a.status==="Under Review"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>f(a.id,{status:"Approved",approvedAt:new Date,approvedBy:"Current User"}),className:"px-3 py-1.5 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Approve"}),e.jsx("button",{onClick:()=>f(a.id,{status:"Rejected"}),className:"px-3 py-1.5 text-sm bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:"Reject"})]})]})]})]},a.id)})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(te,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"ISO 13485:2016 Reference"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:[e.jsx("strong",{children:"Clause 7.3.6"})," — Design and development verification: Confirm design outputs meet design input requirements.",e.jsx("br",{}),e.jsx("strong",{children:"Clause 7.3.7"})," — Design and development validation: Confirm the resulting product meets defined user needs and intended uses."]})]})]})}),q&&e.jsx(ge,{onClose:()=>w(!1)}),k&&V&&e.jsx(je,{report:V,isOpen:k,onClose:()=>{v(!1),T(null)}})]})}export{Se as default};
