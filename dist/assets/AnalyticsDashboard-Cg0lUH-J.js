import{a as x,j as e}from"./vendor-react-Coyc-9rJ.js";import{u as V}from"./index-BahTgtJs.js";import{a1 as B,ad as F,D as E,R as G,A as v,x as I,aJ as J,aH as W,$ as q,a9 as k,aK as H,B as Q}from"./vendor-icons-CczvD28u.js";import{R as m,A as X,C as y,X as N,Y as b,T as h,f as Y,a as C,c as U,g as Z,h as z,i as _,j as ee,k as se,P as ae,d as te,e as w,B as R,l as A}from"./vendor-recharts-8rfK60na.js";import"./vendor-DW9sAQKa.js";import"./vendor-zustand-Bm6pua9f.js";import"./vendor-uuid-CtRu48qb.js";function je(){const{capas:o,ncrs:re,riskAssessments:g,validationReports:le,suppliers:ce,trainingRecords:ie,changeControls:ne,getDashboardMetrics:M,getCAPAStats:S,getNCRStats:O,getSupplierStats:P,getTrainingStats:D,getChangeControlStats:T,getValidationStats:K}=V();M();const a=S(),r=O(),d=P(),c=D(),i=T(),l=K(),$=x.useMemo(()=>["Jul","Aug","Sep","Oct","Nov","Dec","Jan"].map((t,n)=>({month:t,capas:Math.max(0,a.total-n*2+Math.floor(Math.random()*3)),ncrs:Math.max(0,r.total-n+Math.floor(Math.random()*4)),changeControls:Math.max(0,i.total-n*2+Math.floor(Math.random()*2)),compliance:85+Math.floor(Math.random()*10)})),[a.total,r.total,i.total]),p=x.useMemo(()=>{const s=a.total>0?(a.total-a.open)/a.total*25:25,t=r.total>0?(r.total-r.open)/r.total*25:25,n=c.complianceRate/100*25,u=l.passRate/100*25;return Math.round(s+t+n+u)},[a,r,c,l]),j=x.useMemo(()=>[{name:"Open",value:o.filter(s=>s.status==="Open").length,color:"#3b82f6"},{name:"In Progress",value:o.filter(s=>s.status==="In Progress").length,color:"#f59e0b"},{name:"Verification",value:o.filter(s=>s.status==="Verification").length,color:"#8b5cf6"},{name:"Closed",value:o.filter(s=>s.status==="Closed").length,color:"#10b981"},{name:"Overdue",value:o.filter(s=>s.status==="Overdue").length,color:"#ef4444"}].filter(s=>s.value>0),[o]),L=x.useMemo(()=>[{subject:"CAPA",score:a.total>0?(a.total-a.overdue)/a.total*100:100,fullMark:100},{subject:"NCR",score:r.total>0?(r.total-r.open)/r.total*100:100,fullMark:100},{subject:"Training",score:c.complianceRate,fullMark:100},{subject:"Suppliers",score:d.total>0?d.approved/d.total*100:100,fullMark:100},{subject:"Validation",score:l.passRate,fullMark:100},{subject:"Change Ctrl",score:i.total>0?i.approved/i.total*100:100,fullMark:100}],[a,r,c,d,l,i]),f=x.useMemo(()=>{const s={Low:0,Medium:0,High:0,Critical:0};return g.forEach(t=>{s[t.riskLevel]=(s[t.riskLevel]||0)+1}),Object.entries(s).map(([t,n],u)=>({name:t,value:n,color:["#10b981","#f59e0b","#f97316","#ef4444"][u]})).filter(t=>t.value>0)},[g]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Advanced Analytics"}),e.jsx("p",{className:"text-surface-500 mt-1",children:"Comprehensive quality and compliance analytics"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{className:"btn-secondary btn-sm gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),"Filter"]}),e.jsxs("button",{className:"btn-secondary btn-sm gap-2",children:[e.jsx(F,{className:"w-4 h-4"}),"Last 6 Months"]}),e.jsxs("button",{className:"btn-secondary btn-sm gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),"Export"]}),e.jsxs("button",{className:"btn-primary btn-sm gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-1 card p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative inline-flex items-center justify-center w-32 h-32",children:[e.jsxs("svg",{className:"w-32 h-32 transform -rotate-90",children:[e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"currentColor",strokeWidth:"12",fill:"none",className:"text-surface-200 dark:text-gh-border"}),e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"currentColor",strokeWidth:"12",fill:"none",strokeDasharray:`${p/100*352} 352`,className:p>=80?"text-green-500":p>=60?"text-yellow-500":"text-red-500"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:p})})]}),e.jsx("h3",{className:"mt-4 text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Quality Score"}),e.jsx("p",{className:"text-sm text-surface-500",children:"Overall compliance health"})]})}),e.jsxs("div",{className:"lg:col-span-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-surface-500",children:"Open CAPAs"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:a.open})]}),e.jsx("div",{className:`p-3 rounded-lg ${a.overdue>0?"bg-red-100 dark:bg-red-900/20":"bg-green-100 dark:bg-green-900/20"}`,children:a.overdue>0?e.jsx(v,{className:"w-6 h-6 text-red-600 dark:text-red-400"}):e.jsx(I,{className:"w-6 h-6 text-green-600 dark:text-green-400"})})]}),a.overdue>0&&e.jsxs("p",{className:"text-xs text-red-600 mt-2",children:[a.overdue," overdue"]})]}),e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-surface-500",children:"Training Compliance"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:[c.complianceRate.toFixed(0),"%"]})]}),e.jsx("div",{className:`p-3 rounded-lg ${c.complianceRate>=90?"bg-green-100 dark:bg-green-900/20":"bg-yellow-100 dark:bg-yellow-900/20"}`,children:e.jsx(J,{className:`w-6 h-6 ${c.complianceRate>=90?"text-green-600 dark:text-green-400":"text-yellow-600 dark:text-yellow-400"}`})})]}),e.jsxs("p",{className:"text-xs text-surface-500 mt-2",children:[c.overdue," trainings overdue"]})]}),e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-surface-500",children:"Validation Pass Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:[l.passRate.toFixed(0),"%"]})]}),e.jsx("div",{className:`p-3 rounded-lg ${l.passRate>=90?"bg-green-100 dark:bg-green-900/20":"bg-yellow-100 dark:bg-yellow-900/20"}`,children:e.jsx(W,{className:`w-6 h-6 ${l.passRate>=90?"text-green-600 dark:text-green-400":"text-yellow-600 dark:text-yellow-400"}`})})]}),e.jsxs("p",{className:"text-xs text-surface-500 mt-2",children:[l.approved," approved reports"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4 flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-primary-500"}),"Quality Trends (6 Months)"]}),e.jsx(m,{width:"100%",height:300,children:e.jsxs(X,{data:$,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorCapas",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorNcrs",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]})]}),e.jsx(y,{strokeDasharray:"3 3",className:"stroke-surface-200 dark:stroke-gh-border"}),e.jsx(N,{dataKey:"month",className:"text-surface-500"}),e.jsx(b,{className:"text-surface-500"}),e.jsx(h,{contentStyle:{backgroundColor:"var(--color-surface-50)",border:"1px solid var(--color-surface-200)",borderRadius:"8px"}}),e.jsx(Y,{}),e.jsx(C,{type:"monotone",dataKey:"capas",name:"CAPAs",stroke:"#3b82f6",fill:"url(#colorCapas)"}),e.jsx(C,{type:"monotone",dataKey:"ncrs",name:"NCRs",stroke:"#ef4444",fill:"url(#colorNcrs)"}),e.jsx(U,{type:"monotone",dataKey:"compliance",name:"Compliance %",stroke:"#10b981",strokeWidth:2,dot:!1})]})})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4 flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-primary-500"}),"Compliance Overview"]}),e.jsx(m,{width:"100%",height:300,children:e.jsxs(Z,{data:L,children:[e.jsx(z,{className:"stroke-surface-200 dark:stroke-gh-border"}),e.jsx(_,{dataKey:"subject",className:"text-surface-500"}),e.jsx(ee,{angle:30,domain:[0,100]}),e.jsx(se,{name:"Compliance Score",dataKey:"score",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.3}),e.jsx(h,{})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4 flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5 text-primary-500"}),"CAPA Status Distribution"]}),j.length>0?e.jsx(m,{width:"100%",height:250,children:e.jsxs(ae,{children:[e.jsx(te,{data:j,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",label:({name:s,percent:t})=>`${s} ${(t*100).toFixed(0)}%`,children:j.map((s,t)=>e.jsx(w,{fill:s.color},`cell-${t}`))}),e.jsx(h,{})]})}):e.jsx("div",{className:"h-64 flex items-center justify-center text-surface-500",children:"No CAPA data available"})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4 flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5 text-primary-500"}),"Risk Level Distribution"]}),f.length>0?e.jsx(m,{width:"100%",height:250,children:e.jsxs(R,{data:f,layout:"vertical",children:[e.jsx(y,{strokeDasharray:"3 3",className:"stroke-surface-200 dark:stroke-gh-border"}),e.jsx(N,{type:"number"}),e.jsx(b,{type:"category",dataKey:"name"}),e.jsx(h,{}),e.jsx(A,{dataKey:"value",name:"Count",children:f.map((s,t)=>e.jsx(w,{fill:s.color},`cell-${t}`))})]})}):e.jsx("div",{className:"h-64 flex items-center justify-center text-surface-500",children:"No risk assessments available"})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4 flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5 text-primary-500"}),"NCR by Type"]}),Object.keys(r.byType).length>0?e.jsx(m,{width:"100%",height:250,children:e.jsxs(R,{data:Object.entries(r.byType).map(([s,t])=>({name:s,value:t})),children:[e.jsx(y,{strokeDasharray:"3 3",className:"stroke-surface-200 dark:stroke-gh-border"}),e.jsx(N,{dataKey:"name"}),e.jsx(b,{}),e.jsx(h,{}),e.jsx(A,{dataKey:"value",fill:"#3b82f6",radius:[4,4,0,0]})]})}):e.jsx("div",{className:"h-64 flex items-center justify-center text-surface-500",children:"No NCR data available"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:a.total}),e.jsx("p",{className:"text-sm text-surface-500",children:"Total CAPAs"})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:r.total}),e.jsx("p",{className:"text-sm text-surface-500",children:"Total NCRs"})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:g.length}),e.jsx("p",{className:"text-sm text-surface-500",children:"Risk Assessments"})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:d.total}),e.jsx("p",{className:"text-sm text-surface-500",children:"Suppliers"})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:l.total}),e.jsx("p",{className:"text-sm text-surface-500",children:"Validation Reports"})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:i.total}),e.jsx("p",{className:"text-sm text-surface-500",children:"Change Controls"})]})]}),e.jsxs("div",{className:"text-xs text-surface-500 flex items-center gap-2 mt-4",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:"ISO 13485:2016 Clause 8.4 - Analysis of Data | ISO 9001:2015 Clause 9.1 - Monitoring, measurement, analysis and evaluation"})]})]})}export{je as default};
